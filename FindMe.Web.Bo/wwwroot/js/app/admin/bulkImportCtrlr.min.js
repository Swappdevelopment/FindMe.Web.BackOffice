(function(){"use strict";function n(n,t,i,r,u){var f,o,e;$("[data-toggle=tooltip]").tooltip({trigger:"hover"});u.reset();u.title=r.lbl_Import;u.showToolBar=!1;u.showSearchCtrl=!1;u.showSaveBtn=!1;u.addBtnTltp=r.msg_AddClnts;u.refreshBtnTltp=r.msg_RfrshClnts;u.saveBtnTltp=r.msg_SaveClnts;f=this;f.appProps=r;f.showUpload=!0;f.showClear=!1;f.showTable=!1;f.showError=!1;f.hasFile=!1;f.hasSuccess=!1;f.csvItems=[];f.tableHeaders=[];f.errorCount=0;f.errorstatus="";f.errormsg="";f.errorid=0;f.filename="";o=$("#csv");e=document.getElementById("csv-table").getElementsByTagName("tbody")[0].getElementsByTagName("tr");f.uploadCSvForm=function(){for(var r=$("#files").get(0),t=r.files,u=new FormData,i=0;i<t.length;i++)u.append(t[i].name,t[i]);if(t.length===1){var e=function(n){var i,u,r,t;if(n&&n.data)if(n.data.error)f.showUpload=!1,f.showClear=!0,f.showTable=!0,f.errormsg=n.data.error;else if(n.data.addresses){for(t=0;t<n.data.addresses.length;t++){if(i=n.data.addresses[t],t===0)for(u in i)f.tableHeaders.push(u);f.csvItems.push(i)}for(r=f.csvItems.map(function(n){return n.errorMessage}),t=0;t<r.length;t++)r[t]===null?f.hasSuccess=!0:f.errorCount++;f.showUpload=!1;f.showClear=!0;f.showTable=!0}},o=function(n){n.data&&(f.errorstatus=n.status+" - "+n.statusText,f.errormsg=n.data.msg,f.errorid=n.data.id,f.showError=!0)},s=function(){};n({url:"/ApiBulkImport/UploadCSV",method:"POST",data:u,headers:{"Content-Type":undefined},transformRequest:angular.identity}).then(e,o).finally(s);f.errormsg="";r.value="";f.csvItems.length=0;f.tableHeaders.length=0;f.errorCount=0}};f.clearForm=function(){$("#upload").prop("disabled",!0);f.hasSuccess=!1;f.showTable=!1;f.showClear=!1;f.showUpload=!0;f.filename=""};f.showAll=function(){for(var i,t=f.csvItems.map(function(n){return n.errorMessage}),n=0;n<t.length;n++)for(n=0;n<e.length;n++)i=e[n],i.hidden=t[n]===null?!1:!1};f.showAllSuccess=function(){for(var i,t=f.csvItems.map(function(n){return n.errorMessage}),n=0;n<t.length;n++)for(n=0;n<e.length;n++)i=e[n],i.hidden=t[n]===null?!1:!0};f.showAllErrors=function(){for(var i,t=f.csvItems.map(function(n){return n.errorMessage}),n=0;n<t.length;n++)for(n=0;n<e.length;n++)i=e[n],i.hidden=t[n]===null?!0:!1};document.getElementById("files").onchange=function(){var n=document.getElementById("files");t.$apply(function(){f.filename=n.files[0].name})};$("#files").change(function(){$(this).val()?$("#upload").prop("disabled",!1):$("#upload").prop("disabled",!0)})}function t(n,t,i){var r=this;r.appProps=t;r.client=i.client;r.yes=function(){n.close(r.client);toggleGlblWaitVisibility(!0);i.save(i.client,function(){toggleGlblWaitVisibility(!1)},!0)};r.no=function(){n.close()}}angular.module("app-mainmenu").controller("bulkImportCtrlr",["$http","$scope","$uibModal","appProps","headerConfigService",n]);angular.module("app-mainmenu").controller("deleteClientInstanceCtrlr",["$uibModalInstance","appProps","param",t])})();